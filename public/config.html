<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="../src/styles.css">
    <title>Config</title>
</head>
<body class="config__body" onload="loadParams();">
    <header id="config__header">
        <nav>
            <p id="config_titulo--inicial">Configuración inicial</p>
            <p id="config_titulo--pasos">Configuración inicial ( paso <span>1</span> de 5 )</p>
            <div class="header__logo--container">
                <img src="../src/assets/images/logo_1.png" alt="">
            </div>
        </nav>
    </header>
    <div class="config__banner">
        <p>Configuración inicial</p>
    </div>
    <div class="config__pasos" id="inicial">
        <div class="config__pasos--container">
            <p>Tenemos que completar algunos datos para que tu tienda (con los servicios que ofrecés) se pueda ver online.</p>
            <p>En unos pocos pasos vas a tener todo listo!</p>
            <p><b>(Podés continuar con la carga en cualquier momento...)</b></p>
            <button class="btn unselectable">
                <i class="fa fa-play fa-lg" aria-hidden="true"></i>
                COMENZAR
            </button>
            <div class="config__logo--container">
                <img src="../src/assets/images/logoletra_color.png" alt="">
            </div>
        </div>
    </div>
    <div class="config__pasos" id="paso1">
        <div class="config__pasos--container">
            <form class="config__form" autoComplete="off">
                <div>
                    <input type="text"
                        class="config__form--input"
                        name="name"
                        placeholder=""
                        required
                        autoFocus>
                    <span>Tu marca / nombre de fantasía</span>
                </div>
                <div>
                    <input type="text"
                    name="url"
                    class="config__form--input"
                    placeholder=""
                    value="beauting.me/"
                    disabled>
                    <span>Dirección de tu tienda virtual</span>
                </div>
                <div>
                    <input type="text"
                    class="config__form--input"
                    name="what"
                    placeholder=""
                    required>
                    <span>Whatsapp (para que te contacten)</span>
                </div>
                <div>
                    <input type="text" 
                    class="config__form--input"
                    name="address"
                    placeholder=""
                    required>
                    <span>Dirección (donde ofrecés los servicios)</span>
                </div>
                <div>
                    <input type="text" 
                    class="config__form--input"
                    name="floor"
                    placeholder="">
                    <span>Piso - departamento</span>
                </div>
                <div>
                    <input type="text" 
                    class="config__form--input"
                    name="city"
                    placeholder=""
                    required>
                    <span>Ciudad - barrio</span>
                </div>
                <div>
                    <input type="text" 
                    class="config__form--input"
                    name="state"
                    placeholder=""
                    required>
                    <span>Provincia</span>
                </div>
                <button class="btn unselectable" type="submit">
                    <i class="fa fa-angle-right fa-lg" aria-hidden="true"></i>
                        Continuar
                </button>
            </form>
        </div>
    </div>
    <div class="config__pasos" id="paso2">
        <div class="config__pasos--container">
            <p>Es momento de subir el logo (o una imagen que te caracterice).</p>
            <p>Si no tenés uno a mano, podés agregarlo más tarde (mientras tanto utilizaremos el nuestro).</p>
            <button class="btn unselectable">
                <i class="fa fa-upload fa-lg" aria-hidden="true"></i>
                Subir logo
            </button>
            <button class="btn unselectable">
                <i class="fa fa-angle-right fa-lg" aria-hidden="true"></i>
                Omitir paso
            </button>
        </div>
    </div>
    <div class="config__pasos" id="paso3">
        <div class="config__pasos--container">
            <p>Ahora vamos a posicionar tu ubicación en el mapa (el lugar donde brindás los servicios), para que puedan encontrarte por cercanía tus potenciales nuevos clientes.</p>
            <button class="btn unselectable">
                <i class="fa fa-map-marker fa-lg" aria-hidden="true"></i>
                Ubicarte en el mapa
            </button>
            <button class="btn unselectable">
                <i class="fa fa-angle-right fa-lg" aria-hidden="true"></i>
                Continuar
            </button>
        </div>
    </div>
    <div class="config__pasos" id="paso4">
        <div class="config__pasos--container">
            <!-- Paso 4 (reveer) -->
            <p>Completá los horarios de atención para cada día de la semana 
                (marcá los casilleros correspondientes).</p>
            <div class="config__horario--container">
                <table>
                    <thead>
                        <tr>
                            <th style="visibility: visible;"></th>
                            <th>Lun</th>
                            <th>Mar</th>
                            <th>Mié</th>
                            <th>Jue</th>
                            <th>Vie</th>
                        </tr>
                    </thead>
                    <tbody class="config__horario--agenda" id="tb_lun-vie">
                        <!-- Tabla de horarios traida desde la api -->
                    </tbody>
                </table>
                <div class="config__checkweekend--container">
                    <label class="switch">
                        <input type="checkbox" name="chk_weekends" id="chk_weekends" onchange=clickWeekends()>
                        <span class="slider"></span>
                    </label>
                    <label for="chk_weekends" class="label-subtit-horarios unselectable">Sábados y domingos:</label>
                </div>
                <table id="tb_weekend" class="hidden">
                    <thead>
                        <tr>
                            <th style="visibility: visible;"></th>
                            <th>Sab</th>
                            <th>Dom</th>
                        </tr>
                    </thead>
                    <tbody class="config__horario--agenda" id="tb_sab-dom">
                        <!-- Tabla de horarios traida desde la api -->
                    </tbody>
                </table>
            </div>
            <button class="btn unselectable">
                <i class="fa fa-angle-right fa-lg" aria-hidden="true"></i>
                    Continuar
            </button>
        </div>
    </div>
    <div class="config__pasos" id="paso5">
        <div class="config__pasos--container">
            <p>Comienza agregando algunos servicios para que aparezcan 
                en tu tienda virtual (podrás continuar en cualquier momento 
                desde tu cuenta).</p>
            <button class="btn unselectable">
                <i class="fa fa-plus fa-lg" aria-hidden="true"></i>
                Agregar servicio
            </button>
            <div class="config__finalizar">
                <button class="btn unselectable" >
                    <i class="fa fa-check fa-lg" aria-hidden="true"></i>
                        FINALIZAR
                </button>
            </div>
        </div>
    </div>
    <script>
        var mainUrlApi = "http://localhost:3002/";

        // var sched = Array( 
        //     { hr: '08:00', lun: false, mar: false, mie: false, jue: false, vie: false }, 
        //     { hr: '08:30', lun: false, mar: false, mie: false, jue: false, vie: false }, 
        //     { hr: '09:00', lun: false, mar: false, mie: false, jue: false, vie: false },
        //     { hr: '09:30', lun: false, mar: false, mie: false, jue: false, vie: false },
        //     { hr: '10:00', lun: false, mar: false, mie: false, jue: false, vie: false },
        //     { hr: '10:30', lun: false, mar: false, mie: false, jue: false, vie: false },
        //     { hr: '11:00', lun: false, mar: false, mie: false, jue: false, vie: false },
        //     { hr: '11:30', lun: false, mar: false, mie: false, jue: false, vie: false },
        //     { hr: '12:00', lun: false, mar: false, mie: false, jue: false, vie: false },
        //     { hr: '12:30', lun: false, mar: false, mie: false, jue: false, vie: false },
        //     { hr: '13:00', lun: false, mar: false, mie: false, jue: false, vie: false },
        //     { hr: '13:30', lun: false, mar: false, mie: false, jue: false, vie: false },
        //     { hr: '14:00', lun: false, mar: false, mie: false, jue: false, vie: false },
        //     { hr: '14:30', lun: false, mar: false, mie: false, jue: false, vie: false },
        //     { hr: '15:00', lun: false, mar: false, mie: false, jue: false, vie: false },
        //     { hr: '15:30', lun: false, mar: false, mie: false, jue: false, vie: false },
        //     { hr: '16:30', lun: false, mar: false, mie: false, jue: false, vie: false },
        //     { hr: '17:00', lun: false, mar: false, mie: false, jue: false, vie: false },
        //     { hr: '17:30', lun: false, mar: false, mie: false, jue: false, vie: false },
        //     { hr: '18:30', lun: false, mar: false, mie: false, jue: false, vie: false },
        //     { hr: '09:00', lun: false, mar: false, mie: false, jue: false, vie: false },
        //     { hr: '09:00', lun: false, mar: false, mie: false, jue: false, vie: false },
        //     { hr: '09:00', lun: false, mar: false, mie: false, jue: false, vie: false },
        //     { hr: '09:00', lun: false, mar: false, mie: false, jue: false, vie: false },
        //     { hr: '09:00', lun: false, mar: false, mie: false, jue: false, vie: false },
        //     { hr: '09:00', lun: false, mar: false, mie: false, jue: false, vie: false },
        //     { hr: '09:00', lun: false, mar: false, mie: false, jue: false, vie: false },
        //     { hr: '09:00', lun: false, mar: false, mie: false, jue: false, vie: false }
        // );


        const loadParams = () => {

            let url = 'v1/config/schedule';

            console.log('call loadParams:', mainUrlApi, url);
            
            fetch(mainUrlApi + url, { 
                method: 'GET', 
                headers: { 'Content-Type': 'application/json' }, 
                //body: JSON.stringify(params) 
            })
            .then(response => response.json())
            .then(res => {   

                console.log("res:", res);
                
                if (res.status == 'ok') {
                    console.log("got agenda!!! YEAH!");

                    let _html = "";
                    let _html2 = ""
                    for (let i=0; i<res.config.length; i++) {
                        _html +=
                        `<tr>
                            <td class='day-agenda-labels'>
                                ${res.config[i].hr}
                            </td>
                            <td>
                                <div class='cell-agenda'>
                                    <i class='fa fa-close fa-lg' aria-hidden='true'></i>
                                </div>
                            </td>
                            <td>
                                <div class='cell-agenda'>
                                    <i class='fa fa-close fa-lg' aria-hidden='true'></i>
                                </div>
                            </td>
                            <td>
                                <div class='cell-agenda'>
                                    <i class='fa fa-close fa-lg' aria-hidden='true'></i>
                                </div>
                            </td>
                            <td>
                                <div class='cell-agenda'>
                                    <i class='fa fa-close fa-lg' aria-hidden='true'></i>
                                </div>
                            </td>
                            <td>
                                <div class='cell-agenda'>
                                    <i class='fa fa-close fa-lg' aria-hidden='true'></i>
                                </div>
                            </td>
                        </tr>`;
                        _html2 +=
                        `<tr>
                            <td class='day-agenda-labels'>${res.config[i].hr}</td>
                            <td>
                                <div class='cell-agenda'>
                                    <i class='fa fa-close fa-lg' aria-hidden='true'></i>
                                </div>
                            </td>
                            <td>
                                <div class='cell-agenda'>
                                    <i class='fa fa-close fa-lg' aria-hidden='true'></i>
                                </div>
                            </td>
                        </tr>`
                    }

                    document.getElementById('tb_lun-vie').innerHTML = _html;
                    document.getElementById('tb_sab-dom').innerHTML = _html2;
                }
                else if (res.status == 'error') {
                    if (res.data == 1005 || res.data == 5004) {
                        location.href = "/login";
                    }
                    else {
                        console.log("ERROR NO IDENTIFICADO: ", JSON.stringify(res));
                    }
                }
            })
            .catch(err => console.log(err) );
        }

        const clickWeekends = () => {
            let tb_weekend = document.getElementById ("tb_weekend");

            tb_weekend.classList.toggle("hidden");
    }

        loadParams()

    </script>
    <script src="" async defer></script>
</body>
</html>